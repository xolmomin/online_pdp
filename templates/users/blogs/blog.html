{% extends 'users/base.html' %}

{% load static %}

{% block title %}
    Blogs - EduHub Learning Platform
{% endblock %}

{% block custom_css %}
    <style>
        .blog-card {
            background: white;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            border-color: #c7d2fe;
        }

        .animate-slide-up {
            animation: slideUp 0.6s ease-out forwards;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .author-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 12px;
        }

        .category-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #374151;
        }

        .webp-indicator {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .step-count-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .reading-time {
            background: #f3f4f6;
            color: #6b7280;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
        }

        .blog-card:hover {
            opacity: 1;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

    </style>
{% endblock %}

{% block content %}

    <!-- Page Header -->
    <section class="hero-gradient text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-4xl font-bold mb-4">EduHub Blog</h2>
                <p class="text-xl mb-8 max-w-3xl mx-auto opacity-90">
                    Discover insights, tips, and expert advice to accelerate your career and master new skills in the
                    ever-evolving tech landscape.
                </p>
            </div>
        </div>
    </section>

    <!-- Blog Grid -->
    <section class="py-8 flex flex-col h-full">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="blog-grid">

                {% for blog in blogs %}
                    <!-- Blog Card 1 - React Tutorial -->
                    <article class="blog-card card-hover animate-slide-up flex flex-col h-full" data-category="tech"
                             data-date="2024-12-12"
                             data-steps="5">
                        <div class="aspect-video relative">
                            {% if blog.cover_image %}
                                <img src="{{ blog.cover_image.url }}"
                                     alt="{{ blog.title }}"
                                     class="absolute inset-0 w-full h-full object-cover rounded-t-xl"/>
                            {% else %}
                                <img src="{% static 'users/vendors/images/no-picture.webp' %}"
                                     alt="No image available"
                                     class="absolute inset-0 w-full h-full object-cover rounded-t-xl"/>
                            {% endif %}
                        </div>
                        <div class="p-6 flex flex-col flex-1">
                            <a href="#"
                               class="text-xl font-semibold text-gray-900 mb-2 hover:text-purple-600 transition-colors cursor-pointer block">
                                {{ blog.title }}
                            </a>
                            {{ blog.description|truncatewords:15|safe }}
                            <p class="text-gray-600 mb-8 text-sm leading-relaxed">
                            <div class="flex items-center justify-between mt-auto">
                                <div class="flex items-center space-x-2">
                                    <div class="author-avatar">MK</div>
                                    <div class="text-sm">
                                        <div class="font-medium text-gray-900">Mike Chen</div>
                                        <div class="flex items-center space-x-2">
                                            <span class="reading-time">8 min read</span>
                                            <span class="step-count-badge">5 steps</span>
                                        </div>
                                    </div>
                                </div>
                                <span class="text-sm text-gray-500">Dec 12, 2024</span>
                            </div>
                            </p>
                        </div>
                    </article>
                {% endfor %}

            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state hidden">
                <div class="text-6xl mb-4">üìù</div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">No blogs found</h3>
                <p class="text-gray-600 mb-6">Try adjusting your search or filter criteria</p>
                <button onclick="clearFilters()"
                        class="bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                    Clear Filters
                </button>
            </div>
        </div>
    </section>

    <!-- Blog Detail Modal -->
    <div id="blog-detail-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="min-h-screen flex items-start justify-center p-4 py-8">
            <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full relative">
                <!-- Header -->
                <div class="relative">
                    <div id="blog-detail-cover"
                         class="h-64 bg-gradient-to-br from-blue-400 to-blue-600 rounded-t-xl relative overflow-hidden">
                        <div class="absolute inset-0 bg-black bg-opacity-20"></div>
                        <div class="absolute top-4 right-4 flex space-x-2">
                            <button onclick="closeBlogDetail()"
                                    class="bg-white/20 backdrop-blur-sm text-white p-2 rounded-lg hover:bg-white/30 transition-colors"
                                    title="Close">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="absolute bottom-6 left-6 right-6">
                            <h1 id="blog-detail-title" class="text-3xl font-bold text-white mb-2">Blog Title</h1>
                            <div class="flex items-center space-x-4 text-white/90">
                                <div class="flex items-center space-x-2">
                                    <div id="blog-detail-avatar" class="author-avatar">MK</div>
                                    <div>
                                        <div id="blog-detail-author" class="font-medium">Mike Chen</div>
                                        <div class="text-sm opacity-75">Published <span
                                                id="blog-detail-date">Dec 12, 2024</span></div>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-3 text-sm">
                                <span id="blog-detail-reading-time"
                                      class="bg-white/20 px-2 py-1 rounded">8 min read</span>
                                    <span id="blog-detail-steps-count"
                                          class="bg-yellow-500 text-white px-2 py-1 rounded font-semibold">5 steps</span>
                                </div>
                            </div>
                        </div>
                        <div id="blog-detail-icon"
                             class="absolute inset-0 flex items-center justify-center text-6xl opacity-20">üöÄ
                        </div>
                    </div>
                </div>

                <!-- Content -->
                <div class="p-8">
                    <!-- Blog Description -->
                    <div class="prose max-w-none mb-8">
                        <div id="blog-detail-description" class="text-gray-700 leading-relaxed text-lg">
                            Blog description content will be loaded here...
                        </div>
                    </div>

                    <!-- Steps Navigation -->
                    <div class="border-t border-gray-200 pt-8">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-900">Tutorial Steps</h2>
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-gray-500">Step</span>
                                <span id="current-step-number"
                                      class="bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold">1</span>
                                <span class="text-sm text-gray-500">of</span>
                                <span id="total-steps-number" class="text-sm font-semibold text-gray-900">5</span>
                            </div>
                        </div>

                        <!-- Step Content -->
                        <div id="step-content" class="bg-gray-50 rounded-xl p-6 mb-6">
                            <h3 id="step-title" class="text-xl font-semibold text-gray-900 mb-4">Step Title</h3>
                            <div id="step-description" class="prose max-w-none text-gray-700">
                                Step description content...
                            </div>
                        </div>

                        <!-- Step Navigation -->
                        <div class="flex items-center justify-between">
                            <button id="prev-step-btn" onclick="previousStep()"
                                    class="flex items-center space-x-2 px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M15 19l-7-7 7-7"></path>
                                </svg>
                                <span>Previous Step</span>
                            </button>

                            <!-- Step Progress -->
                            <div class="flex items-center space-x-2">
                                <div id="step-indicators" class="flex space-x-2">
                                    <!-- Step indicators will be generated here -->
                                </div>
                            </div>

                            <button id="next-step-btn" onclick="nextStep()"
                                    class="flex items-center space-x-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                <span>Next Step</span>
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>

                        <!-- Step Overview -->
                        <div class="mt-8 bg-white border border-gray-200 rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">All Steps Overview</h3>
                            <div id="steps-overview" class="space-y-3">
                                <!-- Steps overview will be generated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Blog Actions -->
                    <div class="border-t border-gray-200 pt-6 mt-8">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button onclick="likeBlog()"
                                        class="flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-red-500 transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                    </svg>
                                    <span>Like</span>
                                </button>
                                <button onclick="shareBlog()"
                                        class="flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-blue-500 transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                                    </svg>
                                    <span>Share</span>
                                </button>
                                <button onclick="bookmarkBlog()"
                                        class="flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-yellow-500 transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                                    </svg>
                                    <span>Bookmark</span>
                                </button>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button onclick="printBlog()"
                                        class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                                    Print Guide
                                </button>
                                <button onclick="downloadPDF()"
                                        class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                    Download PDF
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pagination -->
    <section class="py-8 bg-white border-t border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-center items-center space-x-2">
                <button class="pagination-button px-3 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-purple-600 hover:text-white transition-colors">
                    Previous
                </button>
                <button class="pagination-button active px-3 py-2 rounded-lg border border-gray-300">1</button>
                <button class="pagination-button px-3 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-purple-600 hover:text-white transition-colors">
                    2
                </button>
                <button class="pagination-button px-3 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-purple-600 hover:text-white transition-colors">
                    3
                </button>
                <span class="px-3 py-2 text-gray-500">...</span>
                <button class="pagination-button px-3 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-purple-600 hover:text-white transition-colors">
                    13
                </button>
                <button class="pagination-button px-3 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-purple-600 hover:text-white transition-colors">
                    Next
                </button>
            </div>
        </div>
    </section>

{% endblock %}

{% block custom_js %}
    <script>

        // Read article functionality
        function readArticle(articleId) {
            const articles = {
                'featured': 'The Complete Guide to Landing Your First Tech Job in 2024',
                'react-2024': 'React 18 Features Every Developer Should Know',
                'salary-negotiation': 'Salary Negotiation Strategies for Software Engineers',
                'system-design': 'System Design Interview: Building Scalable Chat Applications',
                'ai-skills': 'Essential AI Skills for Developers in 2024',
                'remote-work': 'The Future of Remote Work in Tech Companies',
                'productivity': '10 Productivity Hacks Every Developer Should Know'
            };

            const title = articles[articleId] || 'Article';
            alert(`Opening article: "${title}"\n\nThis would navigate to the full article page with detailed content, comments, and related articles.`);
        }

        // Pagination functionality
        const paginationButtons = document.querySelectorAll('.pagination-button');
        paginationButtons.forEach(button => {
            button.addEventListener('click', function () {
                if (this.textContent === 'Previous' || this.textContent === 'Next') {
                    alert(`Navigating to ${this.textContent.toLowerCase()} page...`);
                } else if (!isNaN(this.textContent)) {
                    paginationButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    alert(`Loading page ${this.textContent}...`);
                }
            });
        });

        // Search functionality
        document.querySelector('input[placeholder="Search articles..."]').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const query = this.value;
                if (query.trim()) {
                    alert(`Searching for: "${query}"\n\nThis would filter articles based on your search query and show relevant results.`);
                }
            }
        });

        // Add smooth scrolling and animations on load
        document.addEventListener('DOMContentLoaded', function () {
            const articles = document.querySelectorAll('.blog-card');
            articles.forEach((article, index) => {
                setTimeout(() => {
                    article.classList.add('animate-slide-up');
                }, index * 100);
            });
        });
    </script>
    <script>
        // Blog data simulation (would come from Django backend)
        let allBlogs = [];
        let currentFilter = 'all';
        let currentSort = 'newest';
        let currentBlog = null;
        let currentStepIndex = 0;

        // Sample blog data with detailed content and steps
        const blogDatabase = {
            'react-2024': {
                id: 'react-2024',
                title: 'React 18 Features Every Developer Should Know',
                description: `React 18 introduces groundbreaking features that revolutionize how we build user interfaces. This comprehensive guide explores concurrent rendering, automatic batching, Suspense improvements, and new hooks that will transform your development workflow.

                <h3>What You'll Learn</h3>
                <ul>
                    <li>Concurrent rendering and its performance benefits</li>
                    <li>Automatic batching for better state management</li>
                    <li>Enhanced Suspense with streaming SSR</li>
                    <li>New hooks: useId, useDeferredValue, useTransition</li>
                    <li>Migration strategies from React 17</li>
                </ul>

                <p>Whether you're building small applications or enterprise-scale systems, these React 18 features will help you create faster, more responsive user experiences.</p>`,
                category: 'tech',
                author: 'Mike Chen',
                avatar: 'MK',
                date: '2024-12-12',
                readingTime: '8 min read',
                icon: 'üöÄ',
                gradient: 'from-blue-400 to-blue-600',
                steps: [
                    {
                        id: 'step-1',
                        title: 'Setting Up React 18',
                        description: `<p>First, let's upgrade your project to React 18. This step covers the installation process and initial configuration.</p>

                        <h4>Installation Commands:</h4>
                        <pre><code>npm install react@18 react-dom@18
# or
yarn add react@18 react-dom@18</code></pre>

                        <h4>Update Your Root Component:</h4>
                        <pre><code>// Before (React 17)
import ReactDOM from 'react-dom';
ReactDOM.render(&lt;App /&gt;, document.getElementById('root'));

// After (React 18)
import { createRoot } from 'react-dom/client';
const root = createRoot(document.getElementById('root'));
root.render(&lt;App /&gt;);</code></pre>

                        <p><strong>Important:</strong> The new createRoot API is required to access React 18 features like concurrent rendering.</p>`
                    },
                    {
                        id: 'step-2',
                        title: 'Understanding Concurrent Rendering',
                        description: `<p>Concurrent rendering allows React to interrupt rendering work to handle high-priority updates, making your app more responsive.</p>

                        <h4>Key Benefits:</h4>
                        <ul>
                            <li>Non-blocking rendering</li>
                            <li>Better user experience during heavy computations</li>
                            <li>Automatic prioritization of urgent updates</li>
                        </ul>

                        <h4>Example Implementation:</h4>
                        <pre><code>function App() {
  const [count, setCount] = useState(0);
  const [input, setInput] = useState('');

  // High priority update (user input)
  const handleInputChange = (e) => {
    setInput(e.target.value);
  };

  // Low priority update (can be interrupted)
  const handleCountUpdate = () => {
    startTransition(() => {
      setCount(c => c + 1);
    });
  };

  return (
    &lt;div&gt;
      &lt;input value={input} onChange={handleInputChange} /&gt;
      &lt;button onClick={handleCountUpdate}&gt;Count: {count}&lt;/button&gt;
    &lt;/div&gt;
  );
}</code></pre>`
                    },
                    {
                        id: 'step-3',
                        title: 'Automatic Batching',
                        description: `<p>React 18 automatically batches multiple state updates into a single re-render, even in promises, timeouts, and native event handlers.</p>

                        <h4>Before React 18:</h4>
                        <pre><code>// These would cause 3 separate re-renders
setTimeout(() => {
  setCount(c => c + 1);
  setFlag(f => !f);
  setName('John');
}, 1000);</code></pre>

                        <h4>With React 18:</h4>
                        <pre><code>// These are automatically batched into 1 re-render
setTimeout(() => {
  setCount(c => c + 1);
  setFlag(f => !f);
  setName('John');
}, 1000);</code></pre>

                        <h4>Opting Out of Batching:</h4>
                        <pre><code>import { flushSync } from 'react-dom';

setTimeout(() => {
  flushSync(() => {
    setCount(c => c + 1);
  });
  // React has flushed the DOM here
  flushSync(() => {
    setFlag(f => !f);
  });
  // React has flushed the DOM again
}, 1000);</code></pre>`
                    },
                    {
                        id: 'step-4',
                        title: 'New Hooks: useTransition and useDeferredValue',
                        description: `<p>These hooks help you optimize performance by marking updates as non-urgent and deferring expensive computations.</p>

                        <h4>useTransition Hook:</h4>
                        <pre><code>import { useTransition, useState } from 'react';

function SearchResults() {
  const [isPending, startTransition] = useTransition();
  const [query, setQuery] = useState('');
  const [results, setResults] = useState([]);

  const handleSearch = (value) => {
    setQuery(value); // Urgent update

    startTransition(() => {
      // Non-urgent update - can be interrupted
      setResults(searchData(value));
    });
  };

  return (
    &lt;div&gt;
      &lt;input onChange={(e) => handleSearch(e.target.value)} /&gt;
      {isPending && &lt;div&gt;Searching...&lt;/div&gt;}
      &lt;ResultsList results={results} /&gt;
    &lt;/div&gt;
  );
}</code></pre>

                        <h4>useDeferredValue Hook:</h4>
                        <pre><code>import { useDeferredValue, useState } from 'react';

function App() {
  const [query, setQuery] = useState('');
  const deferredQuery = useDeferredValue(query);

  return (
    &lt;div&gt;
      &lt;input value={query} onChange={(e) => setQuery(e.target.value)} /&gt;
      &lt;ExpensiveComponent query={deferredQuery} /&gt;
    &lt;/div&gt;
  );
}</code></pre>`
                    },
                    {
                        id: 'step-5',
                        title: 'Enhanced Suspense and Error Boundaries',
                        description: `<p>React 18 improves Suspense with better server-side rendering support and more predictable behavior.</p>

                        <h4>Suspense with Data Fetching:</h4>
                        <pre><code>import { Suspense } from 'react';

function App() {
  return (
    &lt;div&gt;
      &lt;Suspense fallback={&lt;div&gt;Loading user...&lt;/div&gt;}&gt;
        &lt;UserProfile /&gt;
      &lt;/Suspense&gt;

      &lt;Suspense fallback={&lt;div&gt;Loading posts...&lt;/div&gt;}&gt;
        &lt;PostsList /&gt;
      &lt;/Suspense&gt;
    &lt;/div&gt;
  );
}</code></pre>

                        <h4>Error Boundary Integration:</h4>
                        <pre><code>class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true };
  }

  render() {
    if (this.state.hasError) {
      return &lt;h1&gt;Something went wrong.&lt;/h1&gt;;
    }
    return this.props.children;
  }
}

// Usage
&lt;ErrorBoundary&gt;
  &lt;Suspense fallback={&lt;Loading /&gt;}&gt;
    &lt;AsyncComponent /&gt;
  &lt;/Suspense&gt;
&lt;/ErrorBoundary&gt;</code></pre>

                        <p><strong>Migration Tip:</strong> Test your existing Suspense boundaries thoroughly as the timing of fallbacks may have changed.</p>`
                    }
                ]
            },
            'django-guide': {
                id: 'django-guide',
                title: 'Complete Django REST API Development Guide',
                description: `Build production-ready REST APIs with Django REST Framework. This comprehensive tutorial covers everything from basic setup to advanced features like authentication, serialization, viewsets, and deployment strategies.

                <h3>What You'll Build</h3>
                <ul>
                    <li>A complete blog API with CRUD operations</li>
                    <li>JWT authentication system</li>
                    <li>Advanced filtering and pagination</li>
                    <li>File upload handling</li>
                    <li>API documentation with Swagger</li>
                </ul>`,
                category: 'tutorial',
                author: 'Sarah Johnson',
                avatar: 'SJ',
                date: '2024-12-10',
                readingTime: '15 min read',
                icon: 'üêç',
                gradient: 'from-green-400 to-green-600',
                steps: [
                    {
                        id: 'step-1',
                        title: 'Project Setup and Installation',
                        description: `<p>Let's start by setting up a new Django project with Django REST Framework.</p>

                        <h4>Create Virtual Environment:</h4>
                        <pre><code>python -m venv blog_api_env
source blog_api_env/bin/activate  # On Windows: blog_api_env\\Scripts\\activate</code></pre>

                        <h4>Install Dependencies:</h4>
                        <pre><code>pip install django djangorestframework
pip install django-cors-headers  # For CORS support
pip install djangorestframework-simplejwt  # For JWT auth</code></pre>

                        <h4>Create Django Project:</h4>
                        <pre><code>django-admin startproject blog_api
cd blog_api
python manage.py startapp blog</code></pre>`
                    },
                    {
                        id: 'step-2',
                        title: 'Configure Settings and Models',
                        description: `<p>Configure Django settings and create our blog models.</p>

                        <h4>Update settings.py:</h4>
                        <pre><code>INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'rest_framework',
    'corsheaders',
    'blog',
]

MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware',
    'django.middleware.security.SecurityMiddleware',
    # ... other middleware
]

REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ],
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticated',
    ],
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 10
}</code></pre>`
                    }
                    // More steps would be added here...
                ]
            }
            // More blog entries would be added here...
        };

        // Initialize blogs from DOM
        function initializeBlogs() {
            const blogCards = document.querySelectorAll('.blog-card');
            allBlogs = Array.from(blogCards).map((card, index) => ({
                id: card.querySelector('h3').onclick.toString().match(/'([^']+)'/)[1],
                title: card.querySelector('h3').textContent,
                description: card.querySelector('p').textContent,
                category: card.dataset.category,
                date: card.dataset.date,
                steps: parseInt(card.dataset.steps),
                element: card
            }));
        }

        // Filter blogs by category
        function filterByCategory(category) {
            currentFilter = category;

            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            applyFilters();
        }

        // Filter blogs by search term
        function filterBlogs() {
            applyFilters();
        }

        // Sort blogs
        function sortBlogs(sortType) {
            currentSort = sortType;
            applyFilters();
        }

        // Apply all filters and sorting
        function applyFilters() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const blogGrid = document.getElementById('blog-grid');
            const emptyState = document.getElementById('empty-state');

            let filteredBlogs = allBlogs.filter(blog => {
                const matchesCategory = currentFilter === 'all' || blog.category === currentFilter;
                const matchesSearch = blog.title.toLowerCase().includes(searchTerm) ||
                    blog.description.toLowerCase().includes(searchTerm);
                return matchesCategory && matchesSearch;
            });

            // Sort blogs
            filteredBlogs.sort((a, b) => {
                switch (currentSort) {
                    case 'newest':
                        return new Date(b.date) - new Date(a.date);
                    case 'oldest':
                        return new Date(a.date) - new Date(b.date);
                    case 'title':
                        return a.title.localeCompare(b.title);
                    case 'steps':
                        return b.steps - a.steps;
                    default:
                        return 0;
                }
            });

            // Hide all blogs first
            allBlogs.forEach(blog => {
                blog.element.style.display = 'none';
            });

            // Show filtered blogs
            if (filteredBlogs.length > 0) {
                filteredBlogs.forEach((blog, index) => {
                    blog.element.style.display = 'block';
                    blog.element.style.animationDelay = `${index * 0.1}s`;
                });
                emptyState.classList.add('hidden');
            } else {
                emptyState.classList.remove('hidden');
            }

            // Update stats
            updateStats(filteredBlogs.length);
        }

        // Update statistics
        function updateStats(visibleCount) {
            document.getElementById('total-blogs').textContent = allBlogs.length;
            document.getElementById('total-steps').textContent = allBlogs.reduce((sum, blog) => sum + blog.steps, 0);
            document.getElementById('webp-optimized').textContent = allBlogs.length; // All are WebP optimized

            // Calculate this month's blogs
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            const thisMonthCount = allBlogs.filter(blog => {
                const blogDate = new Date(blog.date);
                return blogDate.getMonth() === thisMonth && blogDate.getFullYear() === thisYear;
            }).length;
            document.getElementById('this-month').textContent = thisMonthCount;
        }

        // Clear all filters
        function clearFilters() {
            document.getElementById('search-input').value = '';
            document.querySelector('select').value = 'newest';
            filterByCategory('all');
        }

        // Blog actions
        function readArticle(blogId) {
            const blog = blogDatabase[blogId];
            if (!blog) {
                showNotification(`Blog not found: ${blogId} ‚ùå`, 'error');
                return;
            }

            currentBlog = blog;
            currentStepIndex = 0;

            // Update blog detail modal content
            updateBlogDetailModal(blog);

            // Show the modal
            document.getElementById('blog-detail-modal').classList.remove('hidden');

            showNotification(`Opening blog: ${blog.title} üìñ`, 'info');
        }

        // Update blog detail modal with blog data
        function updateBlogDetailModal(blog) {
            // Update header
            document.getElementById('blog-detail-cover').className = `h-64 bg-gradient-to-br ${blog.gradient} rounded-t-xl relative overflow-hidden`;
            document.getElementById('blog-detail-title').textContent = blog.title;
            document.getElementById('blog-detail-category').textContent = blog.category.charAt(0).toUpperCase() + blog.category.slice(1);
            document.getElementById('blog-detail-author').textContent = blog.author;
            document.getElementById('blog-detail-avatar').textContent = blog.avatar;
            document.getElementById('blog-detail-date').textContent = blog.date;
            document.getElementById('blog-detail-reading-time').textContent = blog.readingTime;
            document.getElementById('blog-detail-steps-count').textContent = `${blog.steps.length} steps`;
            document.getElementById('blog-detail-icon').textContent = blog.icon;

            // Update description
            document.getElementById('blog-detail-description').innerHTML = blog.description;

            // Update steps
            document.getElementById('total-steps-number').textContent = blog.steps.length;

            // Generate step indicators
            generateStepIndicators(blog.steps.length);

            // Generate steps overview
            generateStepsOverview(blog.steps);

            // Load first step
            loadStep(0);
        }

        // Generate step indicators
        function generateStepIndicators(totalSteps) {
            const container = document.getElementById('step-indicators');
            container.innerHTML = '';

            for (let i = 0; i < totalSteps; i++) {
                const indicator = document.createElement('button');
                indicator.className = `w-8 h-8 rounded-full text-sm font-semibold transition-colors ${
                    i === currentStepIndex
                        ? 'bg-purple-600 text-white'
                        : 'bg-gray-200 text-gray-600 hover:bg-gray-300'
                }`;
                indicator.textContent = i + 1;
                indicator.onclick = () => loadStep(i);
                container.appendChild(indicator);
            }
        }

        // Generate steps overview
        function generateStepsOverview(steps) {
            const container = document.getElementById('steps-overview');
            container.innerHTML = '';

            steps.forEach((step, index) => {
                const stepElement = document.createElement('div');
                stepElement.className = `flex items-center space-x-3 p-3 rounded-lg cursor-pointer transition-colors ${
                    index === currentStepIndex
                        ? 'bg-purple-50 border border-purple-200'
                        : 'hover:bg-gray-50'
                }`;
                stepElement.onclick = () => loadStep(index);

                stepElement.innerHTML = `
                    <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ${
                    index === currentStepIndex
                        ? 'bg-purple-600 text-white'
                        : 'bg-gray-200 text-gray-600'
                }">
                        ${index + 1}
                    </div>
                    <div class="flex-1">
                        <div class="font-medium text-gray-900">${step.title}</div>
                        <div class="text-sm text-gray-500">Step ${index + 1} of ${steps.length}</div>
                    </div>
                    ${index === currentStepIndex ? '<div class="text-purple-600">üìç</div>' : ''}
                `;

                container.appendChild(stepElement);
            });
        }

        // Load specific step
        function loadStep(stepIndex) {
            if (!currentBlog || stepIndex < 0 || stepIndex >= currentBlog.steps.length) {
                return;
            }

            currentStepIndex = stepIndex;
            const step = currentBlog.steps[stepIndex];

            // Update step content
            document.getElementById('current-step-number').textContent = stepIndex + 1;
            document.getElementById('step-title').textContent = step.title;
            document.getElementById('step-description').innerHTML = step.description;

            // Update navigation buttons
            const prevBtn = document.getElementById('prev-step-btn');
            const nextBtn = document.getElementById('next-step-btn');

            prevBtn.disabled = stepIndex === 0;
            nextBtn.disabled = stepIndex === currentBlog.steps.length - 1;

            if (stepIndex === currentBlog.steps.length - 1) {
                nextBtn.innerHTML = `
                    <span>Complete Tutorial</span>
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                `;
            } else {
                nextBtn.innerHTML = `
                    <span>Next Step</span>
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                `;
            }

            // Update indicators and overview
            generateStepIndicators(currentBlog.steps.length);
            generateStepsOverview(currentBlog.steps);

            // Scroll to top of step content
            document.getElementById('step-content').scrollIntoView({behavior: 'smooth', block: 'start'});
        }

        // Step navigation functions
        function previousStep() {
            if (currentStepIndex > 0) {
                loadStep(currentStepIndex - 1);
            }
        }

        function nextStep() {
            if (currentStepIndex < currentBlog.steps.length - 1) {
                loadStep(currentStepIndex + 1);
            } else {
                // Tutorial completed
                showNotification('üéâ Tutorial completed! Great job!\n\nYou can now bookmark this guide or share it with others.', 'success');
            }
        }

        // Close blog detail modal
        function closeBlogDetail() {
            document.getElementById('blog-detail-modal').classList.add('hidden');
            currentBlog = null;
            currentStepIndex = 0;
        }

        // Edit current blog
        function editCurrentBlog() {
            if (currentBlog) {
                showNotification(`Editing blog: ${currentBlog.title} ‚úèÔ∏è`, 'info');
                // Would open edit modal with current blog data
            }
        }

        // Blog interaction functions
        function likeBlog() {
            showNotification('‚ù§Ô∏è Blog liked! Thanks for your feedback.', 'success');
        }

        function shareBlog() {
            if (currentBlog) {
                const shareText = `Check out this amazing tutorial: ${currentBlog.title}`;
                if (navigator.share) {
                    navigator.share({
                        title: currentBlog.title,
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    navigator.clipboard.writeText(shareText + ' - ' + window.location.href);
                    showNotification('üîó Blog link copied to clipboard!', 'success');
                }
            }
        }

        function bookmarkBlog() {
            showNotification('üîñ Blog bookmarked! You can find it in your saved items.', 'success');
        }

        function printBlog() {
            if (currentBlog) {
                showNotification('üñ®Ô∏è Preparing blog for printing...', 'info');
                // Would generate print-friendly version
            }
        }

        function downloadPDF() {
            if (currentBlog) {
                showNotification('üìÑ Generating PDF... This may take a moment.', 'info');
                // Would generate and download PDF
            }
        }

        function editBlog(blogId) {
            showNotification(`Editing blog: ${blogId} ‚úèÔ∏è`, 'info');
            // Would open edit modal or navigate to edit page
        }

        function deleteBlog(blogId) {
            if (confirm('Are you sure you want to delete this blog? This will also delete all associated steps.')) {
                showNotification(`Blog deleted: ${blogId} üóëÔ∏è`, 'success');
                // Would make DELETE request to Django backend
                // Remove from DOM for demo
                const blogCard = document.querySelector(`[onclick*="${blogId}"]`).closest('.blog-card');
                blogCard.style.animation = 'slideUp 0.3s ease-out reverse';
                setTimeout(() => {
                    blogCard.remove();
                    initializeBlogs();
                    applyFilters();
                }, 300);
            }
        }

        // Modal functions
        function createNewBlog() {
            document.getElementById('blog-modal').classList.remove('hidden');
        }

        function closeBlogModal() {
            document.getElementById('blog-modal').classList.add('hidden');
        }

        function createBlog(event) {
            event.preventDefault();
            showNotification('Blog created successfully! üéâ\n\nImage automatically converted to WebP format.', 'success');
            closeBlogModal();
            // Would make POST request to Django backend
        }

        function previewImage(input) {
            const preview = document.getElementById('image-preview');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.innerHTML = `
                        <img src="${e.target.result}" class="max-w-full h-32 object-cover rounded-lg border">
                        <div class="text-xs text-green-600 mt-2">‚úÖ Will be converted to WebP format</div>
                    `;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function loadMoreBlogs() {
            showNotification('Loading more blogs... üìö', 'info');
            // Would load more blogs from Django backend
        }

        function showAdminPanel() {
            showNotification('Opening Django Admin Panel... ‚öôÔ∏è', 'info');
            // Would navigate to Django admin
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };

            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
            notification.style.maxWidth = '400px';
            notification.innerHTML = `
                <div class="flex items-start space-x-3">
                    <div class="flex-1 text-sm leading-relaxed whitespace-pre-line">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-white hover:text-gray-200">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                notification.style.transform = 'translateX(full)';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            initializeBlogs();
            applyFilters();

            // Animate cards on load
            const cards = document.querySelectorAll('.blog-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });

            showNotification('Welcome to Blog Management! üöÄ\n\nAll images are automatically optimized to WebP format for better performance.', 'success');
        });

        // Close modal when clicking outside
        document.getElementById('blog-modal').addEventListener('click', function (e) {
            if (e.target === this) {
                closeBlogModal();
            }
        });

        // Close blog detail modal when clicking outside
        document.getElementById('blog-detail-modal').addEventListener('click', function (e) {
            if (e.target === this) {
                closeBlogDetail();
            }
        });

        // Keyboard navigation for blog detail modal
        document.addEventListener('keydown', function (e) {
            if (currentBlog && !document.getElementById('blog-detail-modal').classList.contains('hidden')) {
                switch (e.key) {
                    case 'Escape':
                        closeBlogDetail();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        previousStep();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        nextStep();
                        break;
                }
            }
        });
    </script>
{% endblock %}
