{% extends 'users/base.html' %}

{% block title %}
    Complete Web Development Bootcamp - EduHub
{% endblock %}

{% block custom_css %}
    <style>
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .tab-button {
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .rating-stars {
            color: #fbbf24;
        }

        .instructor-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .sticky-sidebar {
            position: sticky;
            top: 100px;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
{% endblock %}

{% block content %}
    <!-- Course Hero Section -->
    <div class="hero-gradient text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <div class="mb-4">
                        <span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-sm font-medium">{{ course.category }}</span>
                        {% if course.has_certificate %}
                            <span class="bg-green-500 text-white px-3 py-1 rounded-full text-sm font-medium ml-2">Certificate</span>
                        {% endif %}
                    </div>
                    <h1 class="text-4xl font-bold mb-4">{{ course.name }}</h1>
                    <p class="text-xl text-white text-opacity-90 mb-6">
                        {{ course.short_description|safe }}
                    </p>
                    <div class="flex items-center mb-6">
                        {% if course.rating <= 1 %}
                            <div class="rating-stars text-2xl">★</div>
                        {% elif course.rating <= 2 %}
                            <div class="rating-stars text-2xl">★★</div>
                        {% elif course.rating <= 3 %}
                            <div class="rating-stars text-2xl">★★★</div>
                        {% elif course.rating <= 4 %}
                            <div class="rating-stars text-2xl">★★★★</div>
                        {% else %}
                            <div class="rating-stars text-2xl">★★★★★</div>
                        {% endif %}
                        <span class="ml-2 text-white text-opacity-90">{{ course.rating }} (2,341 reviews)</span>
                        <span class="ml-4 text-white text-opacity-90">15,847 students</span>
                    </div>

                    <div class="flex items-center space-x-6 text-white text-opacity-90">
                        <div class="flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            {{ course.course_durations|floatformat:1 }} hours of content
                        </div>
                        <div class="flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                            {{ course.course_lessons }} lessons
                        </div>
                        <div class="flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            {{ course.course_level }} Level
                        </div>
                    </div>
                </div>

                <!-- Course Preview Card -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-2xl overflow-hidden">
                        <div class="relative h-48">
                            <img src="{{ course.cover_image.url }}" alt="Background"
                                 class="object-cover w-full h-full"/>
                        </div>

                        <div class="p-6">
                            <div class="text-center mb-4">
                                <span class="text-3xl font-bold text-purple-600">{{ course.price }} sum</span>
                            </div>
                            <button onclick="enrollNow()"
                                    class="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-semibold mb-3">
                                Enroll Now
                            </button>
                            <button class="w-full border border-purple-600 text-purple-600 py-3 rounded-lg hover:bg-purple-50 transition-colors font-medium">
                                Add to Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Main Content Area -->
            <div class="lg:col-span-2">
                <!-- Tab Navigation -->
                <div class="flex space-x-1 mb-8 bg-gray-100 p-1 rounded-lg">
                    <button onclick="showTab('overview')"
                            class="tab-button active flex-1 py-2 px-4 rounded-md font-medium text-center">Overview
                    </button>
                    <button onclick="showTab('curriculum')"
                            class="tab-button flex-1 py-2 px-4 rounded-md font-medium text-center">Curriculum
                    </button>
                    <button onclick="showTab('instructor')"
                            class="tab-button flex-1 py-2 px-4 rounded-md font-medium text-center">Instructor
                    </button>
                    <button onclick="showTab('reviews')"
                            class="tab-button flex-1 py-2 px-4 rounded-md font-medium text-center">Reviews
                    </button>
                </div>

                <!-- Tab Content -->
                <div id="overview-tab" class="tab-content animate-fade-in">
                    <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">What you'll learn</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {% for about in course.abouts.all %}
                                <div class="flex items-start">
                                    <svg class="w-5 h-5 text-green-500 mr-3 mt-1 flex-shrink-0" fill="currentColor"
                                         viewBox="0 0 24 24">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                    <span class="text-gray-700">{{ about.text|safe }}</span>
                                </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">Course Description</h2>
                        <div class="prose max-w-none text-gray-700">
                            <p class="mb-4">{{ course.full_description|safe }}</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm p-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">Requirements</h2>
                        <ul class="space-y-2 text-gray-700">
                            {% for requirement in course.requirements.all %}
                                <li class="flex items-start">
                                    <span class="text-purple-600 mr-2">•</span>
                                    {{ requirement.text|safe }}
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>

                <div id="curriculum-tab" class="tab-content hidden">
                    <div class="bg-white rounded-xl shadow-sm p-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">Course Curriculum</h2>
                        <div class="mb-4 text-sm text-gray-600">
                            <span class="font-medium">Course Progress:</span> {{ course.course_sections }} Sections
                            • {{ course.course_lessons }} Lessons • {{ course.course_durations|floatformat:1 }} hours
                            total
                        </div>
                        <div class="space-y-4">
                            {% for section in course.sections.all %}
                                <!-- Section 1 -->
                                <div class="border border-gray-200 rounded-lg">
                                    <button onclick="toggleSection('section{{ section.id }}')"
                                            class="w-full p-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors">
                                        <div>
                                            <div class="flex items-center mb-1">
                                                {% if section.status == section.Status.PUBLISHED %}
                                                    <span class="bg-purple-100 text-purple-600 px-2 py-1 rounded text-xs font-medium mr-2">{{ section.get_status_display }}</span>
                                                {% else %}
                                                    <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs font-medium mr-2">UNPUBLISHED</span>
                                                {% endif %}

                                                <h3 class="font-semibold text-gray-900">
                                                    Section {{ section.order_number }}: {{ section.name }}</h3>
                                            </div>
                                            <p class="text-sm text-gray-600">{{ section.count_lesson }} lessons
                                                • {{ section.duration_hours|floatformat:1 }}
                                                hours •
                                                Order: {{ section.order_number }}</p>
                                        </div>
                                        <svg id="section{{ section.id }}-icon"
                                             class="w-5 h-5 text-gray-400 transform transition-transform"
                                             fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
                                        </svg>
                                    </button>
                                    <div id="section{{ section.id }}-content" class="hidden border-t border-gray-200">
                                        <div class="p-4 space-y-3">
                                            {% for lesson in section.lessons.all %}
                                                <div class="flex items-center justify-between py-2 hover:bg-gray-50 rounded px-2">
                                                    <div class="flex items-center">
                                                        <div class="flex items-center mr-3">
                                                            <a href="#"
                                                               data-link="{{ lesson.video.url }}"
                                                               onclick="openVideoFrame('{{ lesson.video.url }}', '{{ lesson.id }}')"
                                                               class="text-purple-600 hover:text-purple-800 transition-colors">
                                                                <svg class="w-4 h-4 mr-2" fill="currentColor"
                                                                     viewBox="0 0 24 24">
                                                                    <path d="M8 5v14l11-7z"/>
                                                                </svg>
                                                            </a>
                                                            {% if lesson.status == 'public' %}
                                                                <span class="bg-green-100 text-green-600 px-1.5 py-0.5 rounded text-xs font-medium mr-2">PUBLIC</span>
                                                            {% else %}
                                                                <span class="bg-red-100 text-red-600 px-1.5 py-0.5 rounded text-xs font-medium mr-2">PRIVATE</span>
                                                            {% endif %}
                                                        </div>
                                                        <a href="#"
                                                           data-link="{{ lesson.video.url }}"
                                                           onclick="openVideoFrame('{{ lesson.video.url }}', '{{ lesson.id }}')"
                                                           class="text-gray-700 hover:text-purple-600 transition-colors text-left">
                                                            {{ lesson.name }}
                                                        </a>
                                                    </div>
                                                    <div class="flex items-center space-x-2">
                                                        <span class="text-xs text-gray-500">Order: {{ lesson.order_number }}</span>
                                                        <span class="text-sm text-gray-500">{{ lesson.duration_minutes }}</span>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}

                        </div>

                        <!-- Course Statistics -->
                        <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                            <h4 class="font-semibold text-gray-900 mb-3">Course Statistics</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                <div>
                                    <div class="text-2xl font-bold text-purple-600">{{ course.course_lessons }}</div>
                                    <div class="text-sm text-gray-600">Total Lessons</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold text-purple-600">{{ course.course_durations|floatformat:1 }}</div>
                                    <div class="text-sm text-gray-600">Hours Content</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold text-purple-600">{{ course.practice_count }}</div>
                                    <div class="text-sm text-gray-600">Practice Exercises</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold text-purple-600">{{ course.valid_days }}</div>
                                    <div class="text-sm text-gray-600">Valid Days</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="instructor-tab" class="tab-content hidden">
                    <div class="bg-white rounded-xl shadow-sm p-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">Meet Your Instructor</h2>
                        <div class="flex items-start space-x-6">
                            <div class="instructor-avatar bg-blue-500 flex-shrink-0">JS</div>
                            <div class="flex-grow">
                                <h3 class="text-xl font-bold text-gray-900 mb-2">John Smith</h3>
                                <p class="text-purple-600 font-medium mb-4">Senior Full-Stack Developer & Instructor</p>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600">4.9</div>
                                        <div class="text-sm text-gray-600">Instructor Rating</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600">1,247</div>
                                        <div class="text-sm text-gray-600">Reviews</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600">45,892</div>
                                        <div class="text-sm text-gray-600">Students</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600">12</div>
                                        <div class="text-sm text-gray-600">Courses</div>
                                    </div>
                                </div>
                                <div class="prose max-w-none text-gray-700">
                                    <p class="mb-4">John is a seasoned full-stack developer with over 8 years of
                                        experience
                                        in web development. He has worked with companies like Google, Microsoft, and
                                        several
                                        successful startups.</p>
                                    <p class="mb-4">John specializes in JavaScript, React, Node.js, and modern web
                                        development practices. He's passionate about teaching and has helped thousands
                                        of
                                        students transition into successful web development careers.</p>
                                    <p>When he's not coding or teaching, John enjoys hiking, photography, and
                                        contributing
                                        to open-source projects.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="reviews-tab" class="tab-content hidden">
                    <div class="bg-white rounded-xl shadow-sm p-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-6">Student Reviews</h2>

                        <!-- Review Summary -->
                        <div class="flex items-center mb-8">
                            <div class="text-center mr-8">
                                <div class="text-4xl font-bold text-purple-600 mb-2">4.8</div>
                                <div class="rating-stars text-xl mb-2">★★★★★</div>
                                <div class="text-sm text-gray-600">2,341 reviews</div>
                            </div>
                            <div class="flex-grow">
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <span class="text-sm w-8">5★</span>
                                        <div class="flex-grow bg-gray-200 rounded-full h-2 mx-3">
                                            <div class="progress-bar h-2 rounded-full" style="width: 78%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">78%</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="text-sm w-8">4★</span>
                                        <div class="flex-grow bg-gray-200 rounded-full h-2 mx-3">
                                            <div class="progress-bar h-2 rounded-full" style="width: 15%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">15%</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="text-sm w-8">3★</span>
                                        <div class="flex-grow bg-gray-200 rounded-full h-2 mx-3">
                                            <div class="progress-bar h-2 rounded-full" style="width: 5%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">5%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Individual Reviews -->
                        <div class="space-y-6">
                            <div class="border-b border-gray-200 pb-6">
                                <div class="flex items-start space-x-4">
                                    <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold">
                                        S
                                    </div>
                                    <div class="flex-grow">
                                        <div class="flex items-center mb-2">
                                            <h4 class="font-semibold text-gray-900 mr-3">Sarah Johnson</h4>
                                            <div class="rating-stars text-sm">★★★★★</div>
                                            <span class="text-sm text-gray-500 ml-2">2 weeks ago</span>
                                        </div>
                                        <p class="text-gray-700">This course is absolutely amazing! John explains
                                            everything
                                            so clearly and the projects are really practical. I went from knowing
                                            nothing
                                            about web development to building my own full-stack applications. Highly
                                            recommended!</p>
                                    </div>
                                </div>
                            </div>

                            <div class="border-b border-gray-200 pb-6">
                                <div class="flex items-start space-x-4">
                                    <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold">
                                        M
                                    </div>
                                    <div class="flex-grow">
                                        <div class="flex items-center mb-2">
                                            <h4 class="font-semibold text-gray-900 mr-3">Mike Chen</h4>
                                            <div class="rating-stars text-sm">★★★★★</div>
                                            <span class="text-sm text-gray-500 ml-2">1 month ago</span>
                                        </div>
                                        <p class="text-gray-700">Best web development course I've taken! The curriculum
                                            is
                                            well-structured and up-to-date with modern technologies. The React section
                                            was
                                            particularly helpful for my career transition.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="border-b border-gray-200 pb-6">
                                <div class="flex items-start space-x-4">
                                    <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                                        E
                                    </div>
                                    <div class="flex-grow">
                                        <div class="flex items-center mb-2">
                                            <h4 class="font-semibold text-gray-900 mr-3">Emily Rodriguez</h4>
                                            <div class="rating-stars text-sm">★★★★★</div>
                                            <span class="text-sm text-gray-500 ml-2">3 weeks ago</span>
                                        </div>
                                        <p class="text-gray-700">John is an excellent instructor. The course content is
                                            comprehensive and the hands-on projects really help solidify the concepts. I
                                            landed my first developer job 3 months after completing this course!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <div class="sticky-sidebar">
                    <!-- Course Features -->
                    <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                        <h3 class="font-bold text-gray-900 mb-4">This course includes:</h3>
                        <div class="space-y-3">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-purple-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8 5v14l11-7z"/>
                                </svg>
                                <span class="text-gray-700">{{ course.course_durations|floatformat:1 }} hours on-demand video</span>
                            </div>
                            {% if not course.practice_count == 0 %}
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 text-purple-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                                    </svg>
                                    <span class="text-gray-700">{{ course.practice_count }} practice exercises</span>
                                </div>
                            {% endif %}

                            {% if course.has_certificate %}
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 text-purple-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <span class="text-gray-700">Certificate of Completion Available</span>
                                </div>
                            {% else %}
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 text-purple-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <span class="text-gray-700">No Certificate Offered for This Course</span>
                                </div>
                            {% endif %}

                            {% if course.has_support %}
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 text-green-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                    </svg>
                                    <span class="text-gray-700">Instructor support included</span>
                                </div>
                            {% else %}
                                <div class="flex items-center">
                                    <svg class="w-5 h-5 text-green-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                    </svg>
                                    <span class="text-gray-700">Instructor support NOT included</span>
                                </div>
                            {% endif %}

                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-purple-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                                </svg>
                                <span class="text-gray-700">Access for {{ course.valid_days }} days</span>
                            </div>

                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-purple-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 2 2h12c1.11 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/>
                                </svg>
                                <span class="text-gray-700">Downloadable resources</span>
                            </div>
                        </div>

                        <!-- Course Level & Topic -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-600">Level:</span>
                                <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-sm font-medium">{{ course.course_level }}</span>
                            </div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-600">Topic:</span>
                                <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm font-medium">{{ course.category.name }}</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium text-gray-600">Rating:</span>
                                <div class="flex items-center">
                                    {% if course.rating <= 1 %}
                                        <div class="rating-stars text-sm mr-1">★</div>
                                    {% elif course.rating <= 2 %}
                                        <div class="rating-stars text-sm mr-1">★★</div>
                                    {% elif course.rating <= 3 %}
                                        <div class="rating-stars text-sm mr-1">★★★</div>
                                    {% elif course.rating <= 4 %}
                                        <div class="rating-stars text-sm mr-1">★★★★</div>
                                    {% else %}
                                        <div class="rating-stars text-sm mr-1">★★★★★</div>
                                    {% endif %}
                                    <span class="text-sm text-gray-600">{{ course.rating }}/5.0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Related Courses -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="font-bold text-gray-900 mb-4">Students also bought</h3>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-16 h-12 bg-gradient-to-br from-green-400 to-blue-500 rounded flex-shrink-0"></div>
                                <div class="flex-grow">
                                    <h4 class="font-medium text-gray-900 text-sm">Advanced React Patterns</h4>
                                    <div class="flex items-center justify-between">
                                        <span class="text-xs text-gray-600">★★★★★ 4.7</span>
                                        <span class="font-bold text-purple-600">$79</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-16 h-12 bg-gradient-to-br from-yellow-400 to-red-500 rounded flex-shrink-0"></div>
                                <div class="flex-grow">
                                    <h4 class="font-medium text-gray-900 text-sm">Node.js Masterclass</h4>
                                    <div class="flex items-center justify-between">
                                        <span class="text-xs text-gray-600">★★★★★ 4.9</span>
                                        <span class="font-bold text-purple-600">$99</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 🎥 Video Modal -->
    <div id="videoModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
        <div class="relative w-11/12 md:w-3/4 lg:w-1/2">
            <button onclick="closeVideoModal()" class="absolute -top-8 right-0 text-white text-3xl font-bold">&times;
            </button>
            <video id="hls-video" class="video-js vjs-big-play-centered rounded-xl" controls preload="auto" width="100%"
                   height="auto"
                   data-setup='{"fluid": true}'></video>
        </div>
    </div>

    <!-- Enrollment Modal -->
    <div id="enrollment-modal"
         class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 text-center transform scale-95 transition-transform">
            <div class="mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mb-6">
                <svg class="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 mb-4">Enrollment Successful! 🎉</h3>
            <p class="text-gray-600 mb-6">Welcome to the Complete Web Development Bootcamp! You now have lifetime access
                to
                all course materials.</p>
            <button onclick="closeEnrollmentModal()"
                    class="w-full bg-purple-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                Start Learning
            </button>
        </div>
    </div>
{% endblock %}

{% block custom_js %}
    <!-- 🎥 Video.js va HLS.js kutubxonalari -->
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet"/>
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {

            function convertMp4ToHls(mp4Path, lesson_id) {
                if (!mp4Path.endsWith('.mp4')) return mp4Path;
                const basePath = mp4Path.replace('/media/courses', '/media/courses/hls/').replace('.mp4', '');
                return `${basePath}/${lesson_id}/master.m3u8`;
            }

            const videoElement = document.getElementById('hls-video');
            const player = videojs(videoElement, {
                autoplay: false,
                controls: true,
                preload: 'auto',
                fluid: true,
                responsive: true
            });

            // 🎞 Video ochish
            window.openVideoFrame = function (videoUrl, lessonId) {
                videoUrl = convertMp4ToHls(videoUrl, lessonId);
                if (!videoUrl) return;

                const modal = document.getElementById('videoModal');
                modal.classList.remove('hidden');

                player.pause();
                player.reset();

                if (Hls.isSupported() && videoUrl.endsWith('.m3u8')) {
                    const hls = new Hls({xhrSetup: xhr => xhr.withCredentials = true});
                    hls.loadSource(videoUrl);
                    hls.attachMedia(videoElement);
                    hls.on(Hls.Events.MANIFEST_PARSED, () => player.play());
                } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                    player.src({src: videoUrl, type: 'application/x-mpegURL'});
                    player.play();
                } else {
                    player.src({src: videoUrl, type: 'video/mp4'});
                    player.play();
                }
            }

            // ❌ Yopish
            window.closeVideoModal = function () {
                player.pause();
                document.getElementById('videoModal').classList.add('hidden');
            }

        });
    </script>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });

            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab and mark button as active
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            console.log(event.target.classList);
            event.target.classList.add('active');
        }

        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            const icon = document.getElementById(sectionId + '-icon');

            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        function enrollNow() {
            const modal = document.getElementById('enrollment-modal');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.querySelector('.transform').classList.remove('scale-95');
                modal.querySelector('.transform').classList.add('scale-100');
            }, 100);
        }

        function closeEnrollmentModal() {
            const modal = document.getElementById('enrollment-modal');
            modal.querySelector('.transform').classList.remove('scale-100');
            modal.querySelector('.transform').classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                showNotification('Welcome to your new course! Happy learning! 🚀', 'success');
            }, 200);
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };

            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-white hover:text-gray-200">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

    </script>
{% endblock %}



